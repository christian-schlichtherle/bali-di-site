<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Java Guide | Bali DI</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="The online documentation for Bali DI, a modern dependency injection tool for Java and Scala.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.2190a5e0.css" as="style"><link rel="preload" href="/assets/js/app.b3294add.js" as="script"><link rel="preload" href="/assets/js/2.0ac37c2b.js" as="script"><link rel="preload" href="/assets/js/7.b9aff2ea.js" as="script"><link rel="prefetch" href="/assets/js/10.a549e396.js"><link rel="prefetch" href="/assets/js/3.daf233ae.js"><link rel="prefetch" href="/assets/js/4.e4504939.js"><link rel="prefetch" href="/assets/js/5.821dd582.js"><link rel="prefetch" href="/assets/js/6.7ac54f90.js"><link rel="prefetch" href="/assets/js/8.026edef3.js"><link rel="prefetch" href="/assets/js/9.8dc4a2a0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2190a5e0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Bali DI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/java.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/christian-schlichtherle/bali-di-java" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/christian-schlichtherle/bali-di-scala" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scala Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/guide/java.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Guide
</a></div><div class="nav-item"><a href="https://github.com/christian-schlichtherle/bali-di-java" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Java Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/christian-schlichtherle/bali-di-scala" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Scala Repo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/guide/overview.html" class="sidebar-link">Overview</a></li><li><a href="/guide/java.html" aria-current="page" class="active sidebar-link">Java Guide</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide/java.html#getting-started" class="sidebar-link">Getting Started</a></li><li class="sidebar-sub-header"><a href="/guide/java.html#sample-code" class="sidebar-link">Sample Code</a></li><li class="sidebar-sub-header"><a href="/guide/java.html#demo" class="sidebar-link">Demo</a></li><li class="sidebar-sub-header"><a href="/guide/java.html#advanced-features" class="sidebar-link">Advanced Features</a></li></ul></li><li><a href="/guide/scala.html" class="sidebar-link">Scala Guide</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div><a href="https://github.com/christian-schlichtherle/bali-di-java/releases/latest"><img src="https://img.shields.io/github/release/christian-schlichtherle/bali-di-java.svg" alt="Release Notes"></a> <a href="https://search.maven.org/artifact/global.namespace.bali/bali-java"><img src="https://img.shields.io/maven-central/v/global.namespace.bali/bali-java" alt="Maven Central"></a> <a href="https://www.apache.org/licenses/LICENSE-2.0"><img src="https://img.shields.io/github/license/christian-schlichtherle/bali-di-java.svg" alt="Apache License 2.0"></a> <a href="https://github.com/christian-schlichtherle/bali-di-java/actions?query=workflow%3Atest"><img src="https://github.com/christian-schlichtherle/bali-di-java/workflows/test/badge.svg" alt="Test Workflow"></a></div> <h1 id="java-guide"><a href="#java-guide" class="header-anchor">#</a> Java Guide</h1> <p>Bali DI for Java is a pure annotation processor which generates source code to automate dependency injection.
It supports any compiler which is compliant to Java 8 or later.</p> <p>This project is a sibling of <a href="/guide/scala.html">Bali DI for Scala</a>.
As a sibling, it is based on the exact same concepts and aims for eventual feature parity.</p> <blockquote><p>Bali is also an <a href="https://en.wikipedia.org/wiki/Bali" target="_blank" rel="noopener noreferrer">island<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> between Java and Lombok in Indonesia.
For disambiguation, the name of this project is &quot;Bali DI&quot;, not just &quot;Bali&quot;, where DI is an acronym for
<a href="https://en.wikipedia.org/wiki/Dependency_injection" target="_blank" rel="noopener noreferrer"><em>dependency injection</em><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
In code however, the term &quot;DI&quot; is dropped because there is no ambiguity in this context.</p></blockquote> <h2 id="getting-started"><a href="#getting-started" class="header-anchor">#</a> Getting Started</h2> <p>Bali DI for Java is implemented as an annotation processor for the Java compiler.
If you use Maven, you need to add the following dependency to your project:</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>global.namespace.bali<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>bali-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- see https://github.com/christian-schlichtherle/bali-di/releases/latest --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.11.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>Note that this is a compile-time-only dependency - there is no runtime dependency of your code on Bali DI for Java!</p> <h2 id="sample-code"><a href="#sample-code" class="header-anchor">#</a> Sample Code</h2> <p>This project uses a modular build.
The module <a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/java-sample" target="_blank" rel="noopener noreferrer"><code>bali-java-sample</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
provides lots of sample code showing how to use the annotations and generated source code.
The module is not published on Maven Central however - it is only available as source code.
You can browse the source code
<a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/java-sample/src/main/java/bali/java/sample" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
or clone this project.</p> <p>The module is split into different packages with each package representing an individual, self-contained showcase.
For example, the package
<a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/java-sample/src/main/java/bali/java/sample/greeting" target="_blank" rel="noopener noreferrer"><code>bali.java.sample.greeting</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
showcases a glorified way to produce a simple &quot;Hello world!&quot; message by using different components with dependency
injection.</p> <h2 id="demo"><a href="#demo" class="header-anchor">#</a> Demo</h2> <p>The following sample app prints the current date and time using an instance of the generic type <code>Supplier&lt;Date&gt;</code> as its
clock:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">bali<span class="token punctuation">.</span>java<span class="token punctuation">.</span>sample<span class="token punctuation">.</span>genericclock</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">bali<span class="token punctuation">.</span></span><span class="token class-name">Cache</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">bali<span class="token punctuation">.</span></span><span class="token class-name">Module</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span><span class="token class-name">Supplier</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span></span><span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Module</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GenericClockApp</span> <span class="token punctuation">{</span> <span class="token comment">// (1)</span>

    <span class="token annotation punctuation">@Cache</span>
    <span class="token class-name">Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Date</span><span class="token punctuation">&gt;</span></span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (2)</span>

    <span class="token class-name">Date</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (3)</span>

    <span class="token keyword">default</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;It is now %s.\n&quot;</span><span class="token punctuation">,</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">GenericClockApp</span>$<span class="token punctuation">.</span><span class="token keyword">new</span>$<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (4)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In Bali DI, dependencies get <em>resolved</em> rather than injecting them into components by returning them from abstract,
parameterless methods. Abstract, parameterless methods are also used to declare components and their dependencies in
<em>module interfaces</em>, which is any interface annotated with <code>@Module</code>.</p> <blockquote><p>This recursive design enables components to become dependencies themselves and thus, the composition of components
alias dependencies into larger dependency graphs.
It also enables the composition of modules by declaring them as dependencies of other modules, which is one way to
structure multi-module apps.
Another way is to use (multiple) inheritance from the interface(s) generated by the annotation processor - see below.</p> <p>Because returning dependencies from methods is inherently lazy the dependency graph can even be cyclic,
which is not possible with the common constructor injection idiom alone because that's eager.</p></blockquote> <p>In this case, the module interface <code>GenericClockApp</code> (1) declares the method <code>Supplier&lt;Date&gt; clock()</code> (2). The
type <code>Supplier&lt;Date&gt;</code> has a single dependency returned from its abstract, parameterless public method <code>Date get()</code>. The
code generated by the annotation processor will forward any calls of this method to the method <code>Date get()</code> (3)
in the module interface.</p> <p>When encountering a module interface, the annotation processor generates two additional source files:
The first generated source file wires the dependencies declared in the module interface in another interface. The name
of the generated interface is the same as the module interface with a single <code>$</code> character appended. Therefore, let's
call this the <em>companion interface</em>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">bali<span class="token punctuation">.</span>java<span class="token punctuation">.</span>sample<span class="token punctuation">.</span>genericclock</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@bali.Generated</span><span class="token punctuation">(</span>
        processor <span class="token operator">=</span> <span class="token string">&quot;bali.java.AnnotationProcessor&quot;</span><span class="token punctuation">,</span>
        round <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        timestamp <span class="token operator">=</span> <span class="token string">&quot;2021-08-03T16:45:20.955+01:00&quot;</span><span class="token punctuation">,</span>
        version <span class="token operator">=</span> <span class="token string">&quot;0.11.3&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GenericClockApp</span>$ <span class="token keyword">extends</span> <span class="token class-name">GenericClockApp</span> <span class="token punctuation">{</span> <span class="token comment">// (1)</span>

    <span class="token keyword">static</span> <span class="token class-name">GenericClockApp</span> <span class="token keyword">new</span>$<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (2)</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">GenericClockApp</span>$$<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@bali.Cache</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">bali<span class="token punctuation">.</span></span>CachingStrategy</span><span class="token punctuation">.</span>THREAD_SAFE<span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">default</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span>Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">&gt;</span></span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (3)</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span>Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token class-name">GenericClockApp</span>$<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">default</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (4)</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In this case, the companion interface <code>GenericClockApp$</code> (1) extends the module interface <code>GenericClockApp</code> to wire the
dependency graph as explained before, in particular the module method <code>Supplier&lt;Date&gt; clock()</code> (3).</p> <p>When generating the module method <code>Date get()</code> (4), the annotation processor figures that the return type is not
abstract, so it simply returns a new instance. If this doesn't work, you can write your own default method instead.</p> <p>The companion interface also provides the static method constructor <code>GenericClockApp new$()</code>. The return type is the
module interface, not the companion interface, in order to promote loose coupling. You can extend the companion
interface however, which is useful for advanced scenarios like multi-module apps.</p> <p>The second generated source file caches the wired dependencies as required by the module in another abstract class. The
name of the generated class is the same as the module interface with a double <code>$</code> character appended. Therefore, let's
call this the <em>companion class</em>:</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">bali<span class="token punctuation">.</span>java<span class="token punctuation">.</span>sample<span class="token punctuation">.</span>genericclock</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@bali.Generated</span><span class="token punctuation">(</span>
        processor <span class="token operator">=</span> <span class="token string">&quot;bali.java.AnnotationProcessor&quot;</span><span class="token punctuation">,</span>
        round <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
        timestamp <span class="token operator">=</span> <span class="token string">&quot;2021-08-03T16:45:20.956+01:00&quot;</span><span class="token punctuation">,</span>
        version <span class="token operator">=</span> <span class="token string">&quot;0.11.3&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">GenericClockApp</span>$$ <span class="token keyword">implements</span> <span class="token class-name">GenericClockApp</span>$ <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span>Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">&gt;</span></span> clock<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span>Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">&gt;</span></span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>function<span class="token punctuation">.</span></span>Supplier</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Date</span><span class="token punctuation">&gt;</span></span> value<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> <span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clock<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> <span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>clock<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>clock <span class="token operator">=</span> value <span class="token operator">=</span> <span class="token class-name">GenericClockApp</span>$<span class="token punctuation">.</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You may recognize that this code is a blend of the following design patterns:</p> <dl><dt><strong>Abstract Factory</strong></dt> <dd><p>The module interface <code>GenericClockApp</code> is an abstract factory because clients get access to the clock by
calling the abstract method <code>Supplier&lt;Date&gt; clock()</code> without knowing the implementation class.
The same is true for the method <code>Date get()</code>.</p> <p></p></dd> <dt><strong>Factory Method</strong></dt> <dd><p>The companion interface <code>GenericClockApp$</code> implements these factory methods to create the singleton
clock and the current time.</p> <p></p></dd> <dt><strong>Template Method</strong></dt> <dd><p>The interface <code>Supplier&lt;T&gt;</code> defines the template method <code>T get()</code> to return a completely
generic instance <code>T</code>.</p> <p></p></dd> <dt><strong>Mediator</strong></dt> <dd><p>The anonymous inner class <code>new Supplier&lt;&gt;() { /* ... */ }</code> uses a reference to its enclosing companion
interface <code>GenericClockApp$</code> in order to obtain the current Date by calling the module method
<code>Date get()</code>.</p> <p></p></dd></dl> <p>If there were more dependencies, these patterns would be repeatedly applied to the abstract methods of these types.</p> <h2 id="advanced-features"><a href="#advanced-features" class="header-anchor">#</a> Advanced Features</h2> <p>The <a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/java-sample/src/main/java/bali/java/sample" target="_blank" rel="noopener noreferrer">sample code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
also demonstrates the following advanced features:</p> <ul><li>You can cache the return value of any parameterless method in a module interface or a dependency type by applying the
<a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/annotation/src/main/java/bali/Cache.java" target="_blank" rel="noopener noreferrer"><code>@Cache</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
or
<a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/annotation/src/main/java/bali/CacheNullable.java" target="_blank" rel="noopener noreferrer"><code>@CacheNullable</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
annotation to the method.</li> <li>You can select a caching strategy for non-<code>null</code> return values by applying one of <code>@Cache(DISABLED)</code>,
<code>@Cache(NOT_THREAD_SAFE)</code>, <code>@Cache(THREAD_SAFE)</code> or <code>@Cache(THREAD_LOCAL)</code> to the method, where applying
<code>@Cache(THREAD_SAFE)</code> can be abbreviated to just <code>@Cache</code>.</li> <li>The same caching strategies are available for nullable return values by using the <code>@CacheNullable</code> annotation.</li> <li>You can select a default caching strategy for all abstract, parameterless methods in a module interface or a
dependency type by applying the <code>@Cache</code> annotation to the type itself instead of an individual method. Note that a
default caching strategy only applies to abstract methods.</li> <li>You can also declare abstract methods with (possibly generic) parameters in a module interface in order to use their
parameters as dependencies of the return value.</li> <li>You can apply the
<a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/annotation/src/main/java/bali/Make.java" target="_blank" rel="noopener noreferrer"><code>@Make</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
annotation to abstract methods in module
interfaces in order to take advantage of loose coupling and hide implementation types. The value of the annotation
must be a subclass or subinterface of the method's return class or interface.</li> <li>You can apply the
<a href="https://github.com/christian-schlichtherle/bali-di-java/tree/main/annotation/src/main/java/bali/Lookup.java" target="_blank" rel="noopener noreferrer"><code>@Lookup</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
annotation to abstract, parameterless methods
in dependencies in order to specify the name of a method, field or parameter in a module interface to use as the
dependency of the return value.</li> <li>When applying the <code>@Lookup</code> annotation to an abstract, parameterless method in a module interface, the method does not
get implemented in the companion interface. To bind these dependencies, you can declare the module as a dependency in
another module interface, allowing you to use <em>module composition</em> to structure a large multi-module app.</li> <li>Alternatively, you can extend one or more companion interface(s) in another module interface, allowing you to use
<em>module inheritance</em> to structure a large multi-module app.</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/christian-schlichtherle/bali-di-site/edit/main/docs/guide/java.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/24/2023, 9:01:35 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide/overview.html" class="prev">
        Overview
      </a></span> <span class="next"><a href="/guide/scala.html">
        Scala Guide
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b3294add.js" defer></script><script src="/assets/js/2.0ac37c2b.js" defer></script><script src="/assets/js/7.b9aff2ea.js" defer></script>
  </body>
</html>
